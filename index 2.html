
<!DOCTYPE html>
<html lang="fa">
<head>
  <meta charset="UTF-8">
  <title>ØªÙ‚Ø³ÛŒÙ… Ø¯Ø±Ø¢Ù…Ø¯</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body { font-family: sans-serif; direction: rtl; background: #f9f9f9; padding: 20px; text-align: center; }
    input, button { padding:10px; font-size:16px; margin:10px; border-radius:5px; }
    .result { margin-top:20px; background:#fff; padding:20px; border-radius:10px; box-shadow:0 0 8px rgba(0,0,0,0.1); }
    canvas { max-width:400px; margin-top:20px; }
  </style>
</head>
<body>
  <h1>ØªÙ‚Ø³ÛŒÙ… Ù‡ÙˆØ´Ù…Ù†Ø¯ Ø¯Ø±Ø¢Ù…Ø¯</h1>
  <input type="number" id="income" placeholder="Ù…Ø«Ù„Ø§Ù‹ 10 Ø¯Ù„Ø§Ø±">
  <button onclick="calculate()">Ù…Ø­Ø§Ø³Ø¨Ù‡</button>
  <div class="result" id="output" style="display:none;"></div>
  <canvas id="incomeChart" style="display:none;"></canvas>

  <script>
    function calculate() {
      const income = parseFloat(document.getElementById("income").value);
      if (isNaN(income) || income <= 0) { alert("Ù„Ø·ÙØ§Ù‹ ÛŒÚ© Ù…Ø¨Ù„Øº Ù…Ø¹ØªØ¨Ø± ÙˆØ§Ø±Ø¯ Ú©Ù†."); return; }

      const kh = income * 0.5;
      const km = income * 0.1;
      const pa = income * 0.1;
      const sa = income * 0.3;

      document.getElementById("output").innerHTML = `
        <strong>Ù†ØªØ§ÛŒØ¬ ØªÙ‚Ø³ÛŒÙ…â€ŒØ¨Ù†Ø¯ÛŒ:</strong><br><br>
        ğŸ›’ Ù‡Ø²ÛŒÙ†Ù‡â€ŒÙ‡Ø§ÛŒ Ø±ÙˆØ²Ù…Ø±Ù‡: ${kh.toFixed(2)}<br>
        ğŸ’– Ú©Ù…Ú©: ${km.toFixed(2)}<br>
        ğŸ¦ Ù¾Ø³â€ŒØ§Ù†Ø¯Ø§Ø²: ${pa.toFixed(2)}<br>
        ğŸ’¼ Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ: ${sa.toFixed(2)}
      `;
      document.getElementById("output").style.display = "block";
      localStorage.setItem("lastIncome", income);

      const ctx = document.getElementById("incomeChart").getContext("2d");
      document.getElementById("incomeChart").style.display = "block";
      if (window.chart) window.chart.destroy();
      window.chart = new Chart(ctx, {
        type: 'pie',
        data: {
          labels: ['Ù‡Ø²ÛŒÙ†Ù‡','Ú©Ù…Ú©','Ù¾Ø³â€ŒØ§Ù†Ø¯Ø§Ø²','Ø³Ø±Ù…Ø§ÛŒÙ‡â€ŒÚ¯Ø°Ø§Ø±ÛŒ'],
          datasets:[{data:[kh,km,pa,sa], backgroundColor:['#FF6384','#36A2EB','#FFCE56','#4CAF50']}]
        },
        options:{responsive:true, plugins:{legend:{position:'bottom'}}}
      });
    }

    window.onload = function(){
      const last = localStorage.getItem("lastIncome");
      if (last) { document.getElementById("income").value = last; calculate(); }
    }
  </script>
</body>
</html>
